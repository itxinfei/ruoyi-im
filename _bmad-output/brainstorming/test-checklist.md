# RuoYi-IM 功能测试清单

**测试日期**: 2026-01-29
**测试范围**: 聊天消息功能完善与 BUG 修复

---

## 一、环境准备

### 1.1 启动服务

```bash
# 后端服务 (端口 8080)
cd ruoyi-im-api
mvn spring-boot:run

# 前端服务 (端口 5173)
cd ruoyi-im-web
npm install  # 首次需要安装新依赖 vue-virtual-scroller
npm run dev
```

### 1.2 检查服务状态

| 服务 | 地址 | 状态 |
|------|------|------|
| 后端 API | http://localhost:8080 | ⬜ 正常 |
| 前端界面 | http://localhost:5173 | ⬜ 正常 |
| 数据库 | 172.168.20.222:3306 | ⬜ 连接正常 |
| Redis | 172.168.20.222:6379 | ⬜ 连接正常 |

---

## 二、功能测试

### 2.1 统一错误处理机制

| 测试项 | 操作步骤 | 预期结果 | 实际结果 |
|--------|----------|----------|----------|
| API 错误提示 | 发送消息时断网 | 显示"网络连接失败" | ⬜ |
| 401 未授权 | Token 过期后操作 | 自动跳转登录页 | ⬜ |
| 403 权限错误 | 访问无权限资源 | 显示"没有权限" | ⬜ |
| 静默错误 | 刷新头像 404 | 不显示错误提示 | ⬜ |

### 2.2 消息加载骨架屏

| 测试项 | 操作步骤 | 预期结果 | 实际结果 |
|--------|----------|----------|----------|
| 首次加载 | 进入会话 | 显示 6 条消息骨架屏 | ⬜ |
| 加载更多 | 滚动到顶部加载历史 | 显示 3 条骨架屏 | ⬜ |
| 骨架屏动画 | 观察骨架屏显示 | 有淡入动画效果 | ⬜ |

### 2.3 批量获取已读用户

| 测试项 | 操作步骤 | 预期结果 | 实际结果 |
|--------|----------|----------|----------|
| 单条消息查询 | 悬停查看已读用户 | 正常显示已读用户列表 | ⬜ |
| 批量预加载 | 进入会话 | 自动预加载最近 20 条消息 | ⬜ |
| 性能对比 | 观察 Network 请求 | 减少 HTTP 请求次数 | ⬜ |

### 2.4 虚拟滚动优化

| 测试项 | 操作步骤 | 预期结果 | 实际结果 |
|--------|----------|----------|----------|
| 普通模式 | 消息数 < 100 | 使用普通渲染 | ⬜ |
| 虚拟滚动 | 消息数 ≥ 100 | 自动启用虚拟滚动 | ⬜ |
| 滚动流畅度 | 快速滚动大量消息 | 流畅无卡顿 | ⬜ |
| 滚动到底部 | 点击"回到底部"按钮 | 平滑滚动到底部 | ⬜ |

---

## 三、回归测试

### 3.1 基础消息功能

| 测试项 | 操作步骤 | 预期结果 | 实际结果 |
|--------|----------|----------|----------|
| 发送文本消息 | 输入文本并发送 | 消息正常显示 | ⬜ |
| 发送图片 | 选择图片并发送 | 图片预览正常显示 | ⬜ |
| 发送文件 | 选择文件并发送 | 文件下载正常 | ⬜ |
| 消息撤回 | 撤回 2 分钟内消息 | 显示"消息已撤回" | ⬜ |
| 消息编辑 | 编辑已发送消息 | 编辑后内容正常显示 | ⬜ |
| 消息转发 | 转发消息到其他会话 | 转发成功 | ⬜ |
| 引用回复 | 引用消息并回复 | 引用内容正常显示 | ⬜ |

### 3.2 群聊功能

| 测试项 | 操作步骤 | 预期结果 | 实际结果 |
|--------|----------|----------|----------|
| 已读回执 | 发送群消息后查看 | 显示已读人数和列表 | ⬜ |
| @提及 | @群成员 | @用户正常显示 | ⬜ |
| 拍一拍 | 双击头像 | 显示拍一拍提示 | ⬜ |
| 消息置顶 | 长按消息置顶 | 置顶成功 | ⬜ |

### 3.3 多选功能

| 测试项 | 操作步骤 | 预期结果 | 实际结果 |
|--------|----------|----------|----------|
| 进入多选模式 | 长按消息 | 进入多选模式 | ⬜ |
| 全选/反选 | 点击工具栏按钮 | 全部选中/取消选中 | ⬜ |
| 批量转发 | 选择多条消息转发 | 批量转发成功 | ⬜ |
| 批量删除 | 选择多条消息删除 | 批量删除成功 | ⬜ |

---

## 四、性能测试

### 4.1 消息数量测试

| 消息数 | 渲染时间 | 滚动流畅度 | 内存占用 |
|--------|----------|------------|----------|
| 50 条 | ⬜ | ⬜ | ⬜ |
| 100 条 | ⬜ | ⬜ | ⬜ |
| 500 条 | ⬜ | ⬜ | ⬜ |
| 1000 条 | ⬜ | ⬜ | ⬜ |

### 4.2 API 性能测试

| API | 单次请求 | 批量请求 (100条) | 优化效果 |
|-----|----------|------------------|----------|
| 获取已读用户 | ⬜ | ⬜ | ⬜ |

---

## 五、问题记录

### 5.1 发现的问题

| 问题 | 严重程度 | 状态 | 备注 |
|------|----------|------|------|
| 示例问题 | P0/P1/P2 | 待修复/已忽略 | 描述 |

---

## 六、测试结论

### 6.1 测试总结

- 测试通过率: ____%
- 发现问题数: ____ 个
- 严重问题: ____ 个
- 一般问题: ____ 个

### 6.2 建议

- [ ] 立即修复严重问题
- [ ] 优化一般问题
- [ ] 进行下一轮测试

---

## 七、测试签名

**测试人员**: ______________
**测试日期**: ______________
**版本**: ______________

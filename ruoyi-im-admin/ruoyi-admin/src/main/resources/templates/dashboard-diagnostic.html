<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard è¯Šæ–­å·¥å…·</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
        }
        .test-result {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 10px;
        }
        button:hover {
            background: #0056b3;
        }
        pre {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>ğŸ” Dashboard è¯Šæ–­å·¥å…·</h1>

    <!-- 1. æ£€æŸ¥jQuery -->
    <div class="test-section">
        <div class="test-title">1ï¸âƒ£ æ£€æŸ¥ jQuery</div>
        <div id="jquery-test" class="test-result info">æ£€æµ‹ä¸­...</div>
    </div>

    <!-- 2. æ£€æŸ¥ECharts -->
    <div class="test-section">
        <div class="test-title">2ï¸âƒ£ æ£€æŸ¥ ECharts</div>
        <div id="echarts-test" class="test-result info">æ£€æµ‹ä¸­...</div>
    </div>

    <!-- 3. æµ‹è¯•åŸºç¡€ç»Ÿè®¡API -->
    <div class="test-section">
        <div class="test-title">3ï¸âƒ£ æµ‹è¯•åŸºç¡€ç»Ÿè®¡API</div>
        <button onclick="testBasicAPI()">æµ‹è¯• /im/dashboard/basic</button>
        <div id="basic-api-test" class="test-result info">æœªæµ‹è¯•</div>
    </div>

    <!-- 4. æµ‹è¯•è¶‹åŠ¿API -->
    <div class="test-section">
        <div class="test-title">4ï¸âƒ£ æµ‹è¯•è¶‹åŠ¿API</div>
        <button onclick="testTrendAPI()">æµ‹è¯• /im/dashboard/trend</button>
        <div id="trend-api-test" class="test-result info">æœªæµ‹è¯•</div>
    </div>

    <!-- 5. æ˜¾ç¤ºå“åº”æ•°æ® -->
    <div class="test-section">
        <div class="test-title">5ï¸âƒ£ APIå“åº”è¯¦æƒ…</div>
        <pre id="api-response">ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®æµ‹è¯•API...</pre>
    </div>

    <script th:src="@{/js/jquery.min.js}"></script>
    <script>
        // 1. æ£€æŸ¥jQuery
        if (typeof $ !== 'undefined') {
            $('#jquery-test').removeClass('info').addClass('success').text('âœ… jQuery å·²åŠ è½½ (ç‰ˆæœ¬: ' + $.fn.jquery + ')');
        } else {
            $('#jquery-test').removeClass('info').addClass('error').text('âŒ jQuery æœªåŠ è½½');
        }

        // 2. æ£€æŸ¥ECharts
        if (typeof echarts !== 'undefined') {
            $('#echarts-test').removeClass('info').addClass('success').text('âœ… ECharts å·²åŠ è½½ (ç‰ˆæœ¬: ' + echarts.version + ')');
        } else {
            $('#echarts-test').removeClass('info').addClass('error').text('âŒ ECharts æœªåŠ è½½ - è¯·æ£€æŸ¥ç½‘ç»œæˆ–CDN');
        }

        // 3. æµ‹è¯•åŸºç¡€ç»Ÿè®¡API
        function testBasicAPI() {
            $('#basic-api-test').removeClass('info error success').addClass('info').text('æµ‹è¯•ä¸­...');
            $('#api-response').text('è¯·æ±‚ä¸­...');

            $.ajax({
                url: '/im/dashboard/basic',
                method: 'GET',
                timeout: 10000,
                success: function(response) {
                    $('#basic-api-test').removeClass('info').addClass('success').text('âœ… APIè¯·æ±‚æˆåŠŸ');
                    $('#api-response').text('çŠ¶æ€ç : ' + response.code + '\næ¶ˆæ¯: ' + response.msg + '\næ•°æ®: ' + JSON.stringify(response.data, null, 2));
                },
                error: function(xhr, status, error) {
                    $('#basic-api-test').removeClass('info').addClass('error').text('âŒ APIè¯·æ±‚å¤±è´¥');
                    $('#api-response').text('é”™è¯¯: ' + error + '\nçŠ¶æ€ç : ' + xhr.status + '\nå“åº”æ–‡æœ¬: ' + xhr.responseText);
                }
            });
        }

        // 4. æµ‹è¯•è¶‹åŠ¿API
        function testTrendAPI() {
            $('#trend-api-test').removeClass('info error success').addClass('info').text('æµ‹è¯•ä¸­...');
            $('#api-response').text('è¯·æ±‚ä¸­...');

            $.ajax({
                url: '/im/dashboard/trend?type=user&days=7',
                method: 'GET',
                timeout: 10000,
                success: function(response) {
                    $('#trend-api-test').removeClass('info').addClass('success').text('âœ… APIè¯·æ±‚æˆåŠŸ');
                    $('#api-response').text('çŠ¶æ€ç : ' + response.code + '\næ¶ˆæ¯: ' + response.msg + '\næ•°æ®æ¡æ•°: ' + (response.data ? response.data.length : 0) + '\næ•°æ®: ' + JSON.stringify(response.data, null, 2));
                },
                error: function(xhr, status, error) {
                    $('#trend-api-test').removeClass('info').addClass('error').text('âŒ APIè¯·æ±‚å¤±è´¥');
                    $('#api-response').text('é”™è¯¯: ' + error + '\nçŠ¶æ€ç : ' + xhr.status + '\nå“åº”æ–‡æœ¬: ' + xhr.responseText);
                }
            });
        }
    </script>
</body>
</html>

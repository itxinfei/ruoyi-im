<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ruoyi.im.mapper.ImAttendanceScheduleMapper">

    <resultMap type="com.ruoyi.im.domain.ImAttendanceSchedule" id="ImAttendanceScheduleResult">
        <id property="id" column="id"/>
        <result property="groupId" column="group_id"/>
        <result property="userId" column="user_id"/>
        <result property="shiftId" column="shift_id"/>
        <result property="scheduleDate" column="schedule_date"/>
        <result property="scheduleType" column="schedule_type"/>
        <result property="needCheckIn" column="need_check_in"/>
        <result property="remark" column="remark"/>
        <result property="createTime" column="create_time"/>
        <result property="updateTime" column="update_time"/>
    </resultMap>

    <sql id="selectImAttendanceScheduleVo">
        select id, group_id, user_id, shift_id, schedule_date, schedule_type,
               need_check_in, remark, create_time, update_time
        from im_attendance_schedule
    </sql>

    <select id="selectUserSchedule" resultMap="ImAttendanceScheduleResult">
        <include refid="selectImAttendanceScheduleVo"/>
        where user_id = #{userId}
        and schedule_date between #{startDate} and #{endDate}
        order by schedule_date asc
    </select>

    <select id="selectByDate" resultMap="ImAttendanceScheduleResult">
        <include refid="selectImAttendanceScheduleVo"/>
        where group_id = #{groupId}
        and schedule_date = #{scheduleDate}
    </select>

    <insert id="batchInsert">
        insert into im_attendance_schedule (group_id, user_id, shift_id, schedule_date, schedule_type, need_check_in, create_time, update_time)
        values
        <foreach collection="schedules" item="item" separator=",">
            (#{item.groupId}, #{item.userId}, #{item.shiftId}, #{item.scheduleDate}, #{item.scheduleType}, #{item.needCheckIn}, #{item.createTime}, #{item.updateTime})
        </foreach>
    </insert>

</mapper>

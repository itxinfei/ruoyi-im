# 张三账号功能验证测试报告

**测试对象**: IM即时通讯系统 - 张三账号  
**测试环境**: 预发/测试环境 (数据已通过 SQL 脚本初始化)  
**测试日期**: 2026-02-02  
**测试人员**: 自动化助手/QA

---

## 1. 测试环境概述

为验证 IM 系统的核心功能（私聊、群聊、通讯录），我们为测试账号“张三”构建了独立的测试数据环境。该环境包含预置的好友关系、群组关系以及初始状态数据。

### 1.1 测试账号清单

| 账号标识 | 用户名 | 角色 | 备注 |
| :--- | :--- | :--- | :--- |
| **主测账号** | `zhangsan` | 普通用户 | 本次测试的核心视角 |
| 辅助账号 A | `test_friend_a` | 普通用户 | 用于验证私聊和群管理 |
| 辅助账号 B | `test_friend_b` | 普通用户 | 用于验证被邀请和群聊互动 |
| 辅助账号 C | `test_friend_c` | 普通用户 | 用于验证跨群组交互 |

*注：所有测试账号默认密码为 `123456`*

### 1.2 预置数据结构

*   **好友关系**:
    *   张三 <-> 测试好友A (双向)
    *   张三 <-> 测试好友B (双向)
    *   张三 <-> 测试好友C (双向)
*   **群组关系**:
    *   **张三的测试群**: 张三 (群主), 好友A (管理员), 好友B (成员)
    *   **项目讨论组**: 好友B (群主), 好友C (成员), 张三 (成员)

---

## 2. 测试用例与执行计划

### 2.1 模块一：通讯录管理 (Contacts)

| ID | 测试场景 | 操作步骤 | 预期结果 | 端侧覆盖 |
| :--- | :--- | :--- | :--- | :--- |
| C01 | 好友列表展示 | 登录张三账号，进入“通讯录”标签页 | 列表中应包含 A、B、C 三位好友，且状态正常显示 | Web, iOS, Android |
| C02 | 好友搜索 | 在顶部搜索栏输入“好友A”或 `test_friend_a` | 搜索结果应实时筛选出“测试好友A” | Web, Mobile |
| C03 | 查看好友资料 | 点击“测试好友B”的头像 | 进入详情页，显示头像、昵称、签名，且“发消息”按钮可用 | All |
| C04 | 好友资料同步 | 在 Web 端修改好友A的备注为“A-Remark” | 登录移动端查看好友A的名称 | 移动端应同步显示为“A-Remark” | All |

### 2.2 模块二：私聊功能 (Private Chat)

| ID | 测试场景 | 操作步骤 | 预期结果 | 端侧覆盖 |
| :--- | :--- | :--- | :--- | :--- |
| P01 | 发送文本消息 | 张三向好友A发送“Hello A” | 消息发送成功，状态变为“已发送/已读” | Web -> Mobile |
| P02 | 接收消息通知 | 登录好友A账号 (Mobile)，张三 (Web) 发送消息 | 好友A手机端应收到推送通知，应用内角标更新 | Web -> iOS/Android |
| P03 | 消息历史漫游 | 张三在 Web 端发送消息后，登录 iOS 端 | iOS 端会话列表中应能看到刚才发送的消息历史 | All |
| P04 | 消息类型测试 | 发送表情、图片、文件 | 各类消息均能正常渲染，图片支持预览，文件支持下载 | Web, Mobile |

### 2.3 模块三：群聊功能 (Group Chat)

| ID | 测试场景 | 操作步骤 | 预期结果 | 端侧覆盖 |
| :--- | :--- | :--- | :--- | :--- |
| G01 | 群组列表展示 | 进入“群组”标签页 | 应显示“张三的测试群”和“项目讨论组” | All |
| G02 | 群主权限验证 | 在“张三的测试群”中，移除成员 B | 成员 B 被移除，系统消息提示“B被移出群聊” | Web |
| G03 | 群消息收发 | 在“项目讨论组”发送“项目进度汇报” | 群内其他成员 (B, C) 均能收到消息 | All |
| G04 | @提醒功能 | 在群内输入 @，选择好友A | 消息显示高亮 @块，好友A 收到强提醒 | Web, Mobile |
| G05 | 修改群公告 | 张三在自己创建的群修改公告为“新公告” | 群内所有成员收到群公告更新通知 | All |

---

## 3. 多端数据同步验证 (Sync Verification)

为确保数据一致性，请按以下流程进行验收：

1.  **准备阶段**: 准备一台 iPhone (iOS) 和一台 Android 手机，以及 PC 浏览器。
2.  **Web端操作**: 登录张三账号，在群组“张三的测试群”发送一条消息 "Web Sync Test"。
3.  **移动端验收**:
    *   打开 iOS 客户端，登录张三账号，确认会话列表同步出现该消息。
    *   打开 Android 客户端，登录好友A账号，确认收到该消息推送。
4.  **状态同步**: 在 Web 端将某条消息标记为已读，检查移动端未读计数是否同步减少。

---

## 4. 异常场景处理

*   **弱网测试**: 在移动端开启飞行模式或弱网模拟，发送消息应进入“发送中 -> 失败”状态；恢复网络后，支持点击重发。
*   **并发冲突**: Web 端和移动端同时对同一好友修改备注，以后提交的请求为准 (Last Write Wins)。

---

## 5. 测试数据准备脚本

已生成 SQL 初始化脚本，请在数据库中执行以重置环境：
`d:\MyCode\im\sql\setup_test_env_zhangsan.sql`

执行命令示例：
```bash
mysql -u root -p im_db < sql/setup_test_env_zhangsan.sql
```

---

**报告生成时间**: 2026-02-02

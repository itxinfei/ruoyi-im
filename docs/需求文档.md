# RuoYi-IM 企业即时通讯系统需求文档

> **项目定位**: 参考野火IM的企业内网IM系统，基于RuoYi框架开发，单体架构
> **核心原则**: 功能可用 + UI美观 + 技术简单
> **参考对象**: [野火IM](https://docs.wildfirechat.cn/) - 开源即时通讯解决方案

---

## 文档信息

| 项目 | 内容 |
|------|------|
| 文档版本 | v4.0 |
| 更新日期 | 2026-02-04 |
| 项目状态 | 功能完善阶段 |
| 整体完成度 | 75% |

---

## 一、项目愿景与范围

### 1.1 项目愿景

打造一个适合几十人到百人规模企业的内网即时通讯系统，**参考野火IM**的功能设计和交互体验，基于RuoYi框架开发，保持技术栈简单，单体应用即可满足需求。

**参考对象**: [野火IM](https://docs.wildfirechat.cn/) - 开源即时通讯解决方案

**设计理念**:
- 参考**野火IM**的协议设计（MQTT+Protobuf思想）和功能组织
- 参考**企业协作UI**的简洁风格，注重用户体验
- 基于**RuoYi框架**实现，保持技术栈一致性

### 1.2 技术架构（单体）

```
┌─────────────────────────────────────┐
│         前端 (Vue3 + Element-Plus)   │
└─────────────────────────────────────┘
                 │
                 ▼
┌─────────────────────────────────────┐
│      后端 (Spring Boot + MySQL)     │
│              + Redis                │
└─────────────────────────────────────┘
```

**技术约束**：
- 后端：Spring Boot + MyBatis-Plus + MySQL + Redis
- 前端：Vue3 + Element-Plus + Vite
- 禁止：微服务、MQ、分布式事务、Kubernetes、Docker

### 1.3 部署方式

- **内网部署**：单台服务器即可
- **浏览器访问**：Chrome 90+、Edge 90+、Safari 14+、Firefox 88+

---

## 二、功能完整度对照表（参考野火IM）

| 野火IM模块 | 功能点 | 状态 | 说明 |
|-----------|--------|------|------|
| **即时通讯** | | | |
|---------|--------|------|------|
| **即时通讯** | | | |
| | 单聊 | ✅ 已完成 | 一对一消息收发 |
| | 群聊 | ✅ 已完成 | 最大500人群组 |
| | 消息类型 | ✅ 已完成 | 文本/图片/文件/语音/表情 |
| | 消息撤回 | ✅ 已完成 | 2分钟内可撤回 |
| | 消息编辑 | ✅ 已完成 | 15分钟内可编辑 |
| | 消息转发 | ✅ 已完成 | 单条转发 |
| | 引用回复 | ✅ 已完成 | 引用原消息回复 |
| | @提及 | ✅ 已完成 | 群聊@成员 |
| | 表情回应 | ✅ 已完成 | 消息点赞 |
| | 消息已读 | ✅ 已完成 | 已读回执 |
| | 消息加密 | ✅ 已完成 | AES加密 |
| | 语音消息 | ⚠️ 部分完成 | 前端待完善 |
| | 语音/视频通话 | ⚠️ 部分完成 | 前端UI待完善 |
| **组织架构** | | | |
| | 部门树 | ✅ 已完成 | 企业-部门-成员层级 |
| | 成员搜索 | ✅ 已完成 | 按姓名/手机号搜索 |
| | 在线状态 | ✅ 已完成 | 显示在线/离线 |
| | 好友管理 | ✅ 已完成 | 添加好友、好友分组 |
| | 好友申请 | ✅ 已完成 | 发送/接受/拒绝申请 |
| | 外部联系人 | ✅ 已完成 | 管理外部联系人 |
| **群组管理** | | | |
| | 创建群组 | ✅ 已完成 | 选择成员创建 |
| | 群组解散 | ✅ 已完成 | 群主解散 |
| | 成员管理 | ✅ 已完成 | 添加/移除/管理员 |
| | 群主转让 | ✅ 已完成 | 转让群主 |
| | 群禁言 | ✅ 已完成 | 全员/单人禁言 |
| | 群公告 | ✅ 已完成 | 发布/查看公告 |
| | 群文件 | ✅ 已完成 | 文件上传/下载 |
| **考勤打卡** | | | |
| | 上班打卡 | ✅ 已完成 | 打卡记录 |
| | 下班打卡 | ✅ 已完成 | 打卡记录 |
| | 考勤统计 | ✅ 已完成 | 统计报表 |
| | 考勤组管理 | ✅ 已完成 | 创建考勤组 |
| **审批流程** | | | |
| | 请假审批 | ✅ 已完成 | 申请/审批流程 |
| | 报销审批 | ✅ 已完成 | 申请/审批流程 |
| | 出差审批 | ✅ 已完成 | 申请/审批流程 |
| | 自定义审批 | ✅ 已完成 | 自定义流程 |
| **机器人/频道** | | | |
| | 机器人消息 | ✅ 已完成 | 自动回复消息 |
| | 频道订阅 | ⚠️ 待实现 | 公众号式订阅 |
| | 消息推送 | ✅ 已完成 | WebSocket推送 |
| | 已读回执 | ✅ 已完成 | 查看已读状态 |
| **日程管理** | | | |
| | 日程创建 | ✅ 已完成 | 创建日程 |
| | 日程提醒 | ✅ 已完成 | 提醒通知 |
| | 日历视图 | ✅ 已完成 | 月/周/日视图 |
| **工作报告** | | | |
| | 日报/周报 | ✅ 已完成 | 创建报告 |
| | 报告评论 | ✅ 已完成 | 评论/点赞 |
| **待办事项** | | | |
| | 任务创建 | ✅ 后端完成 | 前端待完善 |
| | 任务状态 | ✅ 后端完成 | 前端待完善 |
| **邮箱模块** | | | |
| | 收发邮件 | ⚠️ 部分完成 | 前端75% |
| | 草稿箱 | ⚠️ 部分完成 | 前端75% |
| | 邮件附件 | ⚠️ 待完善 | 待实现 |
| **文档模块** | | | |
| | 文档管理 | ✅ 已完成 | 创建/编辑/删除 |
| | 富文本编辑 | ✅ 已完成 | 富文本编辑器 |
| | 文档分享 | ✅ 已完成 | 分享链接 |
| | 版本管理 | ✅ 已完成 | 历史版本 |
| | 实时协作 | ❌ 未实现 | P2延后 |
| **视频会议** | | | |
| | 会议创建 | ✅ 已完成 | 创建会议 |
| | 参会管理 | ✅ 已完成 | 邀请/移除 |
| | 屏幕共享 | ✅ 后端完成 | 前端待完善 |
| **企业云盘** | | | |
| | 文件夹管理 | ✅ 已完成 | 创建文件夹 |
| | 文件上传 | ✅ 已完成 | 上传/下载 |
| | 文件分享 | ✅ 已完成 | 分享链接 |
| | 回收站 | ✅ 已完成 | 删除恢复 |
| **应用中心** | | | |
| | 应用市场 | ⚠️ 部分完成 | 55%完成度 |
| | 应用安装 | ⚠️ 部分完成 | 待完善 |
| **管理后台** | | | |
| | 用户管理 | ✅ 已完成 | 用户列表/状态/角色 |
| | 群组管理 | ✅ 已完成 | 群组列表/解散 |
| | 消息管理 | ✅ 已完成 | 消息查询/删除 |
| | 数据统计 | ✅ 已完成 | 数据概览 |

---

## 三、核心业务流程

### 3.1 聊天流程

1. 用户选择联系人/群组
2. 输入消息内容（文本/图片/文件）
3. 点击发送 → 消息立即显示（乐观UI）
4. 后端保存消息并推送给其他成员
5. 对方收到WebSocket推送，显示新消息

### 3.2 群组流程

1. 点击"创建群组" → 选择成员
2. 设置群名称、群头像
3. 创建成功，自动发送群系统消息
4. 群主可管理成员（添加/移除/设管理员）
5. 成员可退出群组，群主可解散群组

### 3.3 组织架构流程

1. 左侧导航选择"通讯录"
2. 显示企业-部门-成员树形结构
3. 点击部门显示部门成员
4. 点击成员发起聊天/查看资料

### 3.4 工作台流程

1. 左侧导航选择"工作台"
2. 显示各功能入口（考勤/审批/日程/报告/待办）
3. 点击对应功能进入操作页面

---

## 四、非功能需求

### 4.1 性能要求

| 指标 | 要求 | 说明 |
|------|------|------|
| 并发在线 | 100人（峰值500人） | 单服务器WebSocket连接 |
| 消息延迟 | ≤300ms | 实时推送延迟 |
| 页面加载 | ≤3s | 首屏渲染时间 |
| 文件上传 | 单文件≤100MB | 图片/文件附件 |

### 4.2 安全要求

| 措施 | 实现方式 | 状态 |
|------|----------|------|
| 网络隔离 | 内网部署，不暴露公网 | ✅ |
| 传输加密 | HTTPS/WSS | ✅ |
| 消息加密 | AES-256-GCM | ✅ |
| 权限控制 | RBAC权限 | ✅ |
| 敏感词过滤 | 敏感词库 | ✅ |

### 4.3 兼容性要求

- Chrome 90+
- Edge 90+
- Safari 14+
- Firefox 88+
- 分辨率：1366×768 及以上

---

## 五、待办清单（按优先级）

### P0 - 核心体验（必须做）

- [x] 语音消息前端完善
- [x] 视频/语音通话前端UI
- [x] 消息发送失败重试
- [x] 图片全屏预览（左右切换）
- [x] 拖拽上传文件

### P1 - 重要功能

- [x] 待办事项前端完善
- [x] 邮箱附件上传
- [x] 邮箱前端优化
- [x] 消息多选批量操作
- [x] 合并转发消息
- [x] 通讯录好友分组界面

### P2 - 增强功能（可延后）

- [x] 应用中心完善
- [x] 实时文档协作
- [x] 链接卡片解析
- [x] 自定义表情包
- [x] 聊天记录导出

---

## 六、风险与假设

### 6.1 风险

| 风险 | 应对 |
|------|------|
| 单体应用性能上限 | 目前百人规模足够，后续可考虑负载均衡 |
| 大模型生成代码质量 | 人工review后再提交 |
| WebRTC兼容性 | 提供降级方案 |

### 6.2 假设

- 部署环境为内网，网络稳定
- 用户使用现代浏览器
- 数据库和Redis与应用部署在同一服务器

---

## 七、参考

- [野火IM开发手册](https://docs.wildfirechat.cn/)
- [野火IM GitHub](https://github.com/wildfirechat/im-server)
- [RuoYi框架文档](http://doc.ruoyi.vip/)
- [Element Plus 文档](https://element-plus.org/)
- [Vue 3 文档](https://cn.vuejs.org/)

---

**变更记录**：

| 版本 | 日期 | 变更内容 |
|------|------|----------|
| v5.0 | 2026-02-05 | 重构：对标改为参考野火IM，调整功能对照表 |
| v4.0 | 2026-02-04 | 重构：精简内容、删除过期项 |
| v3.0 | 2026-01-21 | 精简整理 |
| v2.0 | 2026-01-16 | 聚焦IM核心 |
| v1.0 | 2025-01-08 | 初始版本 |

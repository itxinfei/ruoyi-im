# RuoYi-IM 企业即时通讯系统需求文档

> **项目定位**: 内网部署的企业即时通讯系统,满足几十人到百人规模企业的日常沟通需求  
> **核心原则**: IM聊天功能做好,工作台功能完善,其他功能类似钉钉即可

---

## 文档信息

| 项目 | 内容 |
|------|------|
| 文档版本 | v3.0 |
| 创建日期 | 2025-01-08 |
| 更新日期 | 2026-01-21 |
| 项目状态 | 功能完善阶段 |
| 整体完成度 | 94% |

## 版本说明

**v3.0 更新内容** (2026-01-21):
- 修正功能优先级矛盾(邮箱、文档、应用中心)
- 统一性能指标(并发用户数、消息延迟等)
- 移除技术实现细节(移至技术文档)
- 更新项目当前状态和待完成事项
- 剔除过期和冗余内容

---

## 一、项目概述

### 1.1 项目背景

**核心诉求**: 企业需要一个内网部署的即时通讯系统,数据完全存储在企业内部服务器,保障数据安全。

**适用场景**:
- 几十人到百人规模的内网办公环境
- 对数据安全有要求的企业(金融、政府、科研等)
- 需要与现有系统(若依权限系统)集成的场景

### 1.2 部署架构

```
┌─────────────────────────────────────────┐
│            企业内网环境                  │
│                                         │
│  ┌─────────────────────────────────┐   │
│  │  应用服务器                      │   │
│  │  - ruoyi-im-web (Vue 3 前端)    │   │
│  │  - ruoyi-im-api (Spring Boot)   │   │
│  │  - ruoyi-im-admin (若依管理后台) │   │
│  └─────────────────────────────────┘   │
│                    │                    │
│                    ▼                    │
│  ┌─────────────────────────────────┐   │
│  │  数据存储                        │   │
│  │  - MySQL (聊天记录、用户数据)    │   │
│  │  - Redis (在线状态、会话缓存)    │   │
│  │  - 本地文件系统 (上传文件)       │   │
│  └─────────────────────────────────┘   │
│                                         │
│  ✅ 数据不经过任何第三方服务器          │
│  ✅ 完全内网部署                        │
└─────────────────────────────────────────┘
```

### 1.3 技术栈

| 层次 | 技术选型 | 版本 | 说明 |
|------|----------|------|------|
| **前端** | | | |
| 前端框架 | Vue 3 | 3.3.11 | 组合式API |
| UI组件库 | Element Plus | 2.4.4 | 企业级组件 |
| 构建工具 | Vite | 5.0.7 | 快速构建 |
| 状态管理 | Vuex | 4.1.0 | 全局状态 |
| 实时通信 | WebSocket | 原生API | 消息推送 |
| **后端** | | | |
| 后端框架 | Spring Boot | 2.7.18 | 基于若依 |
| ORM框架 | MyBatis Plus | 3.5.3 | 数据访问 |
| 安全框架 | Spring Security + JWT | - | 权限认证 |
| 缓存 | Redis | 3.0+ | 状态缓存 |
| 数据库 | MySQL | 5.7/8.0 | 数据持久化 |

---

## 二、功能范围

### 2.1 功能优先级定义

| 优先级 | 定义 | 开发策略 |
|--------|------|----------|
| **P0** | 核心功能,必须做好 | 高质量实现,充分测试 |
| **P1** | 重要功能,需完整实现 | 完整实现,基本测试 |
| **P2** | 扩展功能,可延后 | 基础实现或延后开发 |

### 2.2 P0核心功能(必须做好)

#### 2.2.1 消息模块

| 功能 | 说明 | 状态 |
|------|------|------|
| 单聊 | 一对一消息收发 | ✅ 已完成 |
| 群聊 | 多人群组聊天(最大500人) | ✅ 已完成 |
| 消息类型 | 文本、图片、文件、语音、表情 | ✅ 已完成 |
| 消息状态 | 发送中/已发送/已读 | ✅ 已完成 |
| 消息撤回 | 2分钟内可撤回 | ✅ 已完成 |
| 消息编辑 | 15分钟内可编辑 | ✅ 已完成 |
| 消息转发 | 单条/合并转发 | ✅ 已完成 |
| 消息回复 | 引用回复 | ✅ 已完成 |
| @提及 | 群聊中@成员 | ✅ 已完成 |
| 表情回应 | 消息表情回应 | ✅ 已完成 |
| 消息收藏 | 收藏重要消息 | ✅ 已完成 |
| 会话管理 | 最近消息、置顶、免打扰 | ✅ 已完成 |
| 消息搜索 | 按关键词搜索历史消息 | ✅ 已完成 |
| 消息加密 | AES-256-GCM加密 | ✅ 已完成 |

#### 2.2.2 通讯录模块

| 功能 | 说明 | 状态 |
|------|------|------|
| 组织架构 | 企业-部门-成员层级 | ✅ 已完成 |
| 好友关系 | 添加好友、好友列表、好友分组 | ✅ 已完成 |
| 好友申请 | 发送/接受/拒绝好友申请 | ✅ 已完成 |
| 成员搜索 | 按姓名/手机号搜索 | ✅ 已完成 |
| 在线状态 | 显示好友在线/离线 | ✅ 已完成 |
| 外部联系人 | 管理外部联系人 | ✅ 已完成 |

#### 2.2.3 群组模块

| 功能 | 说明 | 状态 |
|------|------|------|
| 群组创建 | 创建群组、选择成员 | ✅ 已完成 |
| 群组解散 | 群主解散群组 | ✅ 已完成 |
| 成员管理 | 添加/移除成员、设置管理员 | ✅ 已完成 |
| 群主转让 | 转让群主权限 | ✅ 已完成 |
| 群禁言 | 全员禁言、单人禁言 | ✅ 已完成 |
| 群公告 | 发布/查看群公告 | ✅ 已完成 |
| 群文件 | 群文件上传/下载 | ✅ 已完成 |
| 黑名单 | 群黑名单管理 | ✅ 已完成 |

### 2.3 P1重要功能(需完整实现)

#### 2.3.1 工作台模块

| 功能 | 说明 | 状态 |
|------|------|------|
| 考勤打卡 | 上班/下班打卡、考勤统计 | ✅ 已完成 |
| 审批流程 | 请假/报销/出差审批 | ✅ 已完成 |
| 日程管理 | 日程创建、提醒、参与者管理 | ✅ 已完成 |
| 工作报告 | 日报/周报/月报、评论、点赞 | ✅ 已完成 |
| 待办事项 | 任务创建、状态管理 | ✅ 后端完成,前端待完善 |

#### 2.3.2 DING消息

| 功能 | 说明 | 状态 |
|------|------|------|
| DING发送 | 重要消息强提醒 | ✅ 已完成 |
| 已读回执 | 查看DING已读状态 | ✅ 已完成 |
| DING确认 | 确认/拒绝DING | ✅ 已完成 |
| DING模板 | 常用DING模板 | ✅ 已完成 |
| 定时DING | 定时发送DING | ✅ 已完成 |

#### 2.3.3 视频通话

| 功能 | 说明 | 状态 |
|------|------|------|
| 发起通话 | 一对一视频通话 | ✅ 后端完成,前端80% |
| 接听/拒绝 | 通话接听和拒绝 | ✅ 后端完成,前端80% |
| WebRTC信令 | 信令服务器 | ✅ 已完成 |
| 通话历史 | 通话记录查询 | ✅ 已完成 |

#### 2.3.4 邮箱模块

> [!IMPORTANT]
> 优先级从P2调整为P1(后端已完成95%,前端75%)

| 功能 | 说明 | 状态 |
|------|------|------|
| 收发邮件 | 收件箱/发件箱 | ✅ 后端完成,前端75% |
| 草稿箱 | 保存草稿 | ✅ 后端完成,前端75% |
| 邮件附件 | 附件上传/下载 | ⚠️ 待完善 |
| 邮件搜索 | 按关键词搜索 | ✅ 已完成 |
| 标记星标 | 重要邮件标记 | ✅ 已完成 |

#### 2.3.5 文档模块

> [!IMPORTANT]
> 明确范围:基础文档管理(P1),实时协作编辑(P2延后)

| 功能 | 说明 | 状态 |
|------|------|------|
| 文档管理 | 创建/编辑/删除文档 | ✅ 已完成 |
| 富文本编辑 | 富文本编辑器 | ✅ 已完成 |
| 文档分享 | 分享链接/邀请协作 | ✅ 已完成 |
| 文档收藏 | 收藏常用文档 | ✅ 已完成 |
| 版本管理 | 历史版本查看 | ✅ 已完成 |
| 文档评论 | 评论系统 | ✅ 已完成 |
| 权限管理 | 所有者/编辑/查看权限 | ✅ 已完成 |

### 2.4 P2扩展功能(可延后)

| 功能 | 说明 | 状态 |
|------|------|------|
| 实时协作编辑 | OT/CRDT算法实现 | ❌ 待实现 |
| 在线表格 | Excel式表格 | ❌ 待实现 |
| 思维导图 | 在线思维导图 | ❌ 待实现 |
| 应用中心 | 应用市场、应用安装 | ⚠️ 部分实现(55%) |
| 报表统计 | 数据可视化 | ⚠️ 基础统计已实现 |

---

## 三、性能要求

> [!NOTE]
> 针对几十人到百人规模的内网环境

| 指标 | 要求 | 说明 |
|------|------|------|
| 并发在线用户 | 100人(峰值500人) | WebSocket连接 |
| 消息推送延迟 | ≤300ms | 实时推送 |
| 页面加载时间 | ≤3s | 首屏渲染 |
| 文件上传 | ≤100MB | 单文件大小限制 |
| 消息存储 | 90天 | 历史消息保留 |

---

## 四、安全要求

| 安全措施 | 实现方式 | 状态 |
|----------|----------|------|
| 网络隔离 | 内网部署,不暴露公网 | ✅ |
| 传输加密 | HTTPS/WSS加密传输 | ✅ |
| 权限控制 | 基于若依的RBAC权限 | ✅ |
| 数据加密 | 消息AES-256-GCM加密 | ✅ |
| 敏感词过滤 | 敏感词库管理 | ✅ |
| 操作审计 | 关键操作日志记录 | ✅ |

---

## 五、当前项目状态

### 5.1 模块完成度

| 模块 | 后端 | 前端 | 整体 | 状态 |
|------|------|------|------|------|
| **消息模块** | 98% | 95% | **96%** | ✅ 已完成 |
| **通讯录** | 95% | 75% | **85%** | ✅ 已完成 |
| **群组** | 95% | 95% | **95%** | ✅ 已完成 |
| **工作台** | 95% | 95% | **95%** | ✅ 已完成 |
| **DING消息** | 90% | 85% | **88%** | ✅ 已完成 |
| **视频通话** | 95% | 80% | **87%** | ✅ 基本完成 |
| **邮箱模块** | 95% | 75% | **85%** | ✅ 基本完成 |
| **文档模块** | 95% | 85% | **90%** | ✅ 基本完成 |
| **应用中心** | 70% | 40% | **55%** | ⚠️ 部分完成 |
| **系统管理** | 90% | 65% | **78%** | ✅ 基本完成 |

**整体完成度**: 约 **94%**

### 5.2 已知问题

1. **前端API对接** - 部分组件仍使用模拟数据,需对接真实API
2. **视频通话前端UI** - WebRTC信令服务已完成,前端UI待完善
3. **邮箱前端完善** - 附件上传功能待完善
4. **应用中心** - 完成度较低,功能不完整
5. **通讯录前端** - 分组管理、好友申请处理界面待完善

---

## 六、待完成事项

### P0(必须完成)

1. ✅ ~~消息模块核心功能~~ (已完成)
2. ✅ ~~群组功能~~ (已完成)
3. ✅ ~~通讯录基础功能~~ (已完成)

### P1(重要功能)

1. [ ] **视频通话前端UI** - 完善通话界面、通话控制
2. [ ] **邮箱前端完善** - 完善附件上传、邮件列表优化
3. [ ] **前端API对接** - 将模拟数据替换为真实API
4. [ ] **通讯录前端完善** - 分组管理、好友申请处理界面
5. [ ] **待办事项前端** - 工作台待办事项UI

### P2(可延后)

1. [ ] **应用中心完善** - 应用市场、应用安装、应用配置
2. [ ] **报表统计** - 数据可视化、统计图表
3. [ ] **实时协作编辑** - OT/CRDT算法实现
4. [ ] **在线表格/思维导图** - 扩展文档类型

---

## 七、验收标准

### 7.1 IM核心功能验收

**消息收发**:
- [x] 文本消息发送/接收正常
- [x] 图片/文件上传/下载正常
- [x] 消息状态(发送中/已发送/已读)正确
- [x] 消息撤回/编辑功能正常

**群聊功能**:
- [x] 创建群组正常
- [x] 群成员管理(添加/移除)正常
- [x] 群消息正常推送
- [x] 群公告/群文件功能正常

**通讯录**:
- [x] 组织架构显示正常
- [x] 好友添加/列表正常
- [x] 在线状态正确显示

### 7.2 工作台功能验收

**考勤打卡**:
- [x] 上班/下班打卡正常
- [x] 打卡记录查询正常
- [x] 考勤统计正确

**审批流程**:
- [x] 创建审批正常
- [x] 审批流程流转正常
- [x] 审批记录查询正常

**日程管理**:
- [x] 日程创建/编辑/删除正常
- [x] 日程提醒功能正常
- [x] 参与者管理正常

### 7.3 性能验收

- [ ] 100人并发在线测试通过
- [ ] 消息推送延迟≤300ms
- [ ] 页面加载时间≤3s
- [ ] 文件上传(100MB)正常

---

## 八、参考文档

| 文档 | 说明 |
|------|------|
| `需求与代码差距分析报告.md` | 项目进度详细分析(v3.8) |
| `数据库架构文档.md` | 数据表结构详细设计 |
| `API接口文档.md` | 后端API接口清单 |
| `部署运维指南.md` | 部署和运维说明 |
| `性能优化方案.md` | 性能优化建议 |
| `安全增强方案.md` | 安全加固方案 |

---

## 变更记录

| 版本 | 日期 | 变更内容 |
|------|------|----------|
| v3.0 | 2026-01-21 | 精简整理:修正优先级矛盾、统一性能指标、移除技术细节、更新项目状态 |
| v2.0 | 2026-01-16 | 重写文档,聚焦IM核心,简化功能范围 |
| v1.0 | 2025-01-08 | 初始版本,追求100%复刻钉钉 |
